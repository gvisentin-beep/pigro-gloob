<!doctype html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Gloob — Metodo Pigro</title>

    <link rel="icon" type="image/png" href="/static/logo.png" />
    <link rel="stylesheet" href="/static/style_4.css" />

    <!-- Chart.js + time adapter -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.30.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3"></script>

    <style>
      #chartWrap { height: 520px; }
      @media (max-width: 680px) { #chartWrap { height: 420px; } }

      .brand { display:flex; align-items:center; gap:12px; margin:18px 0 6px; }
      .brand img { width:42px; height:42px; }
      .brand h1 { margin:0; font-size:40px; line-height:1; }
      .brand .sub { margin:0; font-size:18px; font-weight:700; opacity:.85; }

      .controlsRow { display:flex; flex-wrap:wrap; gap:14px; align-items:end; }
      .ctrl { min-width:220px; }
      .finalBox { margin-left:auto; font-weight:700; padding-bottom:4px; }
      .muted { opacity:.75; font-size:13px; }

      #ask_status { display:none; margin-top:10px; padding:10px 12px; border-radius:10px; }
      #ask_status.info { background:#eef4ff; }
      #ask_status.ok { background:#e9f7ef; }
      #ask_status.err { background:#fdecec; border:1px solid #f3b5b5; }

      #ask_remaining { margin-left:10px; font-weight:700; }

      /* ✅ stampa/PDF: nascondi elementi inutili */
      @media print {
        .noPrint { display:none !important; }
        body { background: white !important; }
        .container { max-width: 100% !important; }
        #chartWrap { height: 520px !important; }
      }

      /* ✅ MODAL consulenti */
      .modalOverlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,.45);
        display: none;
        align-items: center;
        justify-content: center;
        padding: 18px;
        z-index: 9999;
      }
      .modalOverlay.show { display: flex; }
      .modalBox {
        width: min(860px, 100%);
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 18px 45px rgba(0,0,0,.22);
        padding: 16px 16px 12px;
      }
      .modalTop {
        display:flex;
        align-items:flex-start;
        justify-content: space-between;
        gap: 12px;
        margin-bottom: 8px;
      }
      .modalTop h2 { margin: 0; font-size: 20px; }
      .modalClose {
        border: 0;
        border-radius: 10px;
        padding: 8px 10px;
        cursor: pointer;
        font-weight: 700;
      }
      .consGrid {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 12px;
        margin-top: 12px;
      }
      @media (max-width: 860px) {
        .consGrid { grid-template-columns: 1fr; }
      }
      .consCard {
        border: 1px solid rgba(0,0,0,.08);
        border-radius: 14px;
        padding: 12px;
      }
      .consName { margin: 0 0 6px; font-size: 16px; }
      .consMeta { margin: 0; font-size: 13px; opacity: .85; }
      .consLinks { margin-top: 10px; font-size: 13px; }
      .consLinks a { text-decoration: underline; }
      .modalNote {
        margin-top: 12px;
        font-size: 12px;
        opacity: .85;
        line-height: 1.35;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <!-- BRAND HEADER -->
      <div class="brand">
        <img src="/static/logo.png" alt="Logo Gloob" />
        <div>
          <h1>Gloob</h1>
          <p class="sub">Metodo Pigro</p>
        </div>
      </div>

      <p>Due strumenti globali. Nessuna previsione. Solo disciplina.</p>
      <ul>
        <li><b>Pochi strumenti</b>: due mattoni globali</li>
        <li><b>Costi bassi</b>: struttura semplice</li>
        <li><b>Regole chiare</b>: ribilanciamento una volta l’anno</li>
        <li><b>Struttura &gt; Previsioni</b></li>
      </ul>

      <!-- CONTROLLI -->
      <div class="card noPrint">
        <div class="controlsRow">
          <div class="ctrl" style="flex: 1 1 320px;">
            <label for="w_gold"><b>Oro (%) (0–50, step 5)</b> <span id="w_gold_val">20%</span></label><br />
            <input id="w_gold" type="range" min="0" max="50" step="5" value="20" style="width: 100%;" />
          </div>

          <div class="ctrl">
            <label for="initial"><b>Capitale (€)</b></label><br />
            <input id="initial" type="text" value="10.000" inputmode="numeric" />
          </div>

          <div class="ctrl">
            <button id="btn_update" class="btn">Aggiorna</button>
          </div>

          <!-- ✅ tasto Facsimile / PDF (già presente) -->
          <div class="ctrl">
            <button id="btn_pdf" class="btn">PDF</button>
          </div>

          <!-- ✅ nuovo tasto: messo alla fine della riga, accanto al facsimile/PDF -->
          <div class="ctrl">
            <button id="btn_consulenti" class="btn">Consulenti fee-only (OCF)</button>
          </div>

          <div class="finalBox">
            Finale: <span id="final_value">—</span>
            <span class="muted">(in anni <span id="final_years">—</span>)</span>
          </div>
        </div>

        <p class="muted">Il grafico include andamento e riepilogo.</p>
      </div>

      <!-- METRICHE -->
      <div class="card">
        <div><b id="metrics_line1">Portafoglio (ETF Azion-Obblig + ETC Oro): …</b></div>
        <div id="metrics_line2">Composizione: …</div>
        <div id="metrics_line3">Raddoppio del portafoglio in anni: …</div>
      </div>

      <!-- GRAFICO -->
      <div class="card" id="chartWrap">
        <canvas id="chart"></canvas>
      </div>

      <!-- ✅ scritta richiesta sotto grafico -->
      <div class="muted" style="margin-top:8px;">
        <span id="data_updated">Dati aggiornati al —</span>
      </div>

      <!-- SECONDA PARTE -->
      <div class="card">
        <b>Messaggio chiave:</b><br />
        La differenza non è indovinare il mercato.<br />
        È avere una struttura semplice e ribilanciarla una volta l’anno.
      </div>

      <div class="card">
        <h2>Come applicarlo concretamente</h2>
        <ol>
          <li>Scegli le percentuali (es. 80% ETF Azion-Obblig – 20% Oro).</li>
          <li>Investi nei due strumenti attraverso la tua banca con “execution only”.</li>
          <li>Non intervenire durante l’anno.</li>
          <li>A dicembre ribilancia ai pesi originali.</li>
        </ol>
      </div>

      <div class="grid2">
        <!-- DOMANDE LIBERE -->
        <div class="card noPrint">
          <h2>Domande libere</h2>
          <p class="muted">
            Scrivi una domanda. Riceverai una risposta dall’assistente (nessun dato viene salvato sul sito).<br />
            <b>Tip:</b> su PC invia con <b>Ctrl+Invio</b>.
          </p>

          <textarea id="ask_question" rows="5" placeholder="Scrivi qui la tua domanda…"></textarea>

          <div style="display:flex; align-items:center; gap:8px; margin-top:10px;">
            <button id="ask_btn" class="btn">Chiedi all’assistente</button>
            <span id="ask_remaining" class="muted"></span>
          </div>

          <div id="ask_status" class="info"></div>

          <div id="ask_answer" class="card" style="margin-top:12px; white-space: pre-wrap;"></div>

          <p class="muted" style="margin-top:10px;">
            Nota: risposta informativa, non consulenza finanziaria.
          </p>
        </div>

        <!-- FAQ -->
        <div class="card">
          <h2>FAQ (passa il mouse)</h2>
          <p class="muted">Su mobile: tocca la domanda per vedere la risposta.</p>

          <details><summary><b>1) Perché solo due strumenti?</b></summary>
            <p>Per semplicità, costi bassi e disciplina. Due “mattoni” ben scelti spesso battono strategie complesse.</p>
          </details>

          <details><summary><b>2) Cos’è l’ETF Azion-Obblig?</b></summary>
            <p>Un unico ETF globale “bilanciato”. Qui assumiamo 80% azioni e 20% obbligazioni.</p>
          </details>

          <details><summary><b>3) Perché aggiungere oro?</b></summary>
            <p>Per diversificare e ridurre i ribassi in alcune fasi di mercato.</p>
          </details>

          <details><summary><b>4) Quando ribilanciare?</b></summary>
            <p>Una volta l’anno (es. a dicembre), riportando i pesi a quelli scelti.</p>
          </details>

          <details><summary><b>5) Devo “indovinare” il momento giusto?</b></summary>
            <p>No: la logica è evitare market timing. Conta la disciplina nel tempo.</p>
          </details>

          <details><summary><b>6) Cosa succede se dopo l’acquisto scende?</b></summary>
            <p>È normale. La strategia presuppone volatilità e orizzonte lungo.</p>
          </details>

          <details><summary><b>7) Perché “execution only”?</b></summary>
            <p>Per ridurre conflitti di interesse e costi. Decidi tu la struttura.</p>
          </details>

          <details><summary><b>8) Che importo serve per iniziare?</b></summary>
            <p>Non esiste una cifra unica: l’importante è iniziare sostenibile e restare coerenti.</p>
          </details>

          <details><summary><b>9) Ogni quanto guardare il portafoglio?</b></summary>
            <p>Il meno possibile: controlli periodici, non quotidiani.</p>
          </details>

          <details><summary><b>10) Questo è un consiglio personalizzato?</b></summary>
            <p>No. È informazione generale, non consulenza finanziaria personalizzata.</p>
          </details>
        </div>
      </div>
    </div>

    <!-- ✅ MODAL: consulenti fee-only (OCF) -->
    <div id="consModal" class="modalOverlay noPrint" aria-hidden="true">
      <div class="modalBox" role="dialog" aria-modal="true" aria-label="Consulenti fee-only (OCF)">
        <div class="modalTop">
          <div>
            <h2>Consulenti indipendenti (fee-only) — verificabili su OCF</h2>
            <div class="muted">
              Gloob fornisce solo informazione/analisi generica. Per consulenza personalizzata puoi contattare un professionista esterno.
            </div>
          </div>
          <button class="modalClose" id="consModalClose" aria-label="Chiudi">✕</button>
        </div>

        <div class="consGrid">
          <!-- Consulente 1 -->
          <div class="consCard">
            <p class="consName"><b>Nome Cognome</b></p>
            <p class="consMeta">Consulente finanziario autonomo (fee-only)</p>
            <div class="consLinks">
              Email: <a href="mailto:email@example.com">email@example.com</a><br />
              Tel: <a href="tel:+390000000000">+39 000 000 0000</a><br />
              Sito: <a href="https://example.com" target="_blank" rel="noopener noreferrer">example.com</a><br />
              Verifica OCF: <a href="https://www.organismocf.it" target="_blank" rel="noopener noreferrer">Registro OCF</a>
            </div>
          </div>

          <!-- Consulente 2 -->
          <div class="consCard">
            <p class="consName"><b>Nome Cognome</b></p>
            <p class="consMeta">Consulente finanziario autonomo (fee-only)</p>
            <div class="consLinks">
              Email: <a href="mailto:email@example.com">email@example.com</a><br />
              Tel: <a href="tel:+390000000000">+39 000 000 0000</a><br />
              Sito: <a href="https://example.com" target="_blank" rel="noopener noreferrer">example.com</a><br />
              Verifica OCF: <a href="https://www.organismocf.it" target="_blank" rel="noopener noreferrer">Registro OCF</a>
            </div>
          </div>

          <!-- Consulente 3 -->
          <div class="consCard">
            <p class="consName"><b>Nome Cognome</b></p>
            <p class="consMeta">Consulente finanziario autonomo (fee-only)</p>
            <div class="consLinks">
              Email: <a href="mailto:email@example.com">email@example.com</a><br />
              Tel: <a href="tel:+390000000000">+39 000 000 0000</a><br />
              Sito: <a href="https://example.com" target="_blank" rel="noopener noreferrer">example.com</a><br />
              Verifica OCF: <a href="https://www.organismocf.it" target="_blank" rel="noopener noreferrer">Registro OCF</a>
            </div>
          </div>
        </div>

        <div class="modalNote">
          <b>Trasparenza:</b> i consulenti elencati sono <u>soggetti terzi</u>. Gloob non fornisce consulenza finanziaria personalizzata,
          non raccoglie dati per finalità di consulenza, e non percepisce compensi/commissioni per i contatti generati (salvo diversa indicazione esplicita).
          Verifica sempre l’iscrizione e lo stato sul registro pubblico OCF.
        </div>
      </div>
    </div>

    <script src="/static/app.js"></script>

    <!-- ✅ JS modal consulenti (non tocca app.js) -->
    <script>
      (function () {
        const btn = document.getElementById("btn_consulenti");
        const modal = document.getElementById("consModal");
        const closeBtn = document.getElementById("consModalClose");

        function openModal() {
          if (!modal) return;
          modal.classList.add("show");
          modal.setAttribute("aria-hidden", "false");
        }

        function closeModal() {
          if (!modal) return;
          modal.classList.remove("show");
          modal.setAttribute("aria-hidden", "true");
        }

        if (btn) btn.addEventListener("click", openModal);
        if (closeBtn) closeBtn.addEventListener("click", closeModal);

        if (modal) {
          modal.addEventListener("click", function (e) {
            if (e.target === modal) closeModal();
          });
        }

        document.addEventListener("keydown", function (e) {
          if (e.key === "Escape") closeModal();
        });
      })();
    </script>
  </body>
</html>
