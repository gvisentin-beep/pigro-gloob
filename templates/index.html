<!doctype html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Gloob ‚Äî Metodo Pigro</title>

    <link rel="icon" type="image/png" href="/static/logo.png" />
    <link rel="stylesheet" href="/static/style_4.css" />

    <!-- Chart.js + time adapter -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.30.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3"></script>

    <style>
      #chartWrap { height: 520px; }
      @media (max-width: 680px) { #chartWrap { height: 420px; } }

      .brand { display:flex; align-items:center; gap:12px; margin:18px 0 6px; }
      .brand img { width:42px; height:42px; }
      .brand h1 { margin:0; font-size:40px; line-height:1; }
      .brand .sub { margin:0; font-size:18px; font-weight:700; opacity:.85; }

      .controlsRow { display:flex; flex-wrap:wrap; gap:14px; align-items:end; }
      .ctrl { min-width:220px; }
      .finalBox { margin-left:auto; font-weight:700; padding-bottom:4px; }
      .muted { opacity:.75; font-size:13px; }

      #ask_status { display:none; margin-top:10px; padding:10px 12px; border-radius:10px; }
      #ask_status.info { background:#eef4ff; }
      #ask_status.ok { background:#e9f7ef; }
      #ask_status.err { background:#fdecec; border:1px solid #f3b5b5; }

      #ask_remaining { margin-left:10px; font-weight:700; }

      /* ‚úÖ stampa/PDF: nascondi elementi inutili */
      @media print {
        .noPrint { display:none !important; }
        body { background: white !important; }
        .container { max-width: 100% !important; }
        #chartWrap { height: 520px !important; }
      }

      /* ==============================
         ‚úÖ Execution only + Faxsimile
         ============================== */
      .execution-only-wrap{
        display:inline-flex;
        align-items:center;
        gap:10px;
        position:relative;
      }

      .execution-only-trigger{
        position:relative;
        font-weight:700;
        cursor:help;
        color:#1f4e79;
        text-decoration:none;
      }
      .execution-only-trigger:hover{
        text-decoration:underline;
      }

      /* Tooltip con anteprima PDF */
      .pdf-tooltip{
        display:none;
        position:absolute;
        top:28px;
        left:0;
        width:420px;
        height:520px;
        border:2px solid #cfcfcf;
        background:#fff;
        box-shadow:0 8px 22px rgba(0,0,0,.22);
        border-radius:10px;
        overflow:hidden;
        z-index:9999;
      }
      .pdf-tooltip iframe{
        width:100%;
        height:100%;
        border:0;
      }
      /* mostra tooltip quando passi sul testo */
      .execution-only-wrap:hover .pdf-tooltip{
        display:block;
      }

      /* Bottone Faxsimile */
      .fax-btn{
        display:inline-flex;
        align-items:center;
        gap:8px;
        padding:5px 10px;
        border-radius:8px;
        background:#1f4e79;
        color:#fff;
        text-decoration:none;
        font-size:14px;
        font-weight:700;
        line-height:1;
        white-space:nowrap;
        transition:.18s ease;
      }
      .fax-btn:hover{
        background:#163a5c;
        transform:scale(1.02);
      }

      /* Su schermi piccoli: tooltip pi√π compatto */
      @media (max-width: 680px){
        .pdf-tooltip{
          width:92vw;
          height:65vh;
          left:0;
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <!-- BRAND HEADER -->
      <div class="brand">
        <img src="/static/logo.png" alt="Logo Gloob" />
        <div>
          <h1>Gloob</h1>
          <p class="sub">Metodo Pigro</p>
        </div>
      </div>

      <p>Due strumenti globali. Nessuna previsione. Solo disciplina.</p>
      <ul>
        <li><b>Pochi strumenti</b>: due mattoni globali</li>
        <li><b>Costi bassi</b>: struttura semplice</li>
        <li><b>Regole chiare</b>: ribilanciamento una volta l‚Äôanno</li>
        <li><b>Struttura &gt; Previsioni</b></li>
      </ul>

      <!-- CONTROLLI -->
      <div class="card noPrint">
        <div class="controlsRow">
          <div class="ctrl" style="flex: 1 1 320px;">
            <label for="w_gold"><b>Oro (%) (0‚Äì50, step 5)</b> <span id="w_gold_val">20%</span></label><br />
            <input id="w_gold" type="range" min="0" max="50" step="5" value="20" style="width: 100%;" />
          </div>

          <div class="ctrl">
            <label for="initial"><b>Capitale (‚Ç¨)</b></label><br />
            <input id="initial" type="text" value="10.000" inputmode="numeric" />
          </div>

          <div class="ctrl">
            <button id="btn_update" class="btn">Aggiorna</button>
          </div>

          <!-- ‚úÖ tasto PDF -->
          <div class="ctrl">
            <button id="btn_pdf" class="btn">PDF</button>
          </div>

          <div class="finalBox">
            Finale: <span id="final_value">‚Äî</span>
            <span class="muted">(in anni <span id="final_years">‚Äî</span>)</span>
          </div>
        </div>

        <p class="muted">Il grafico include andamento e riepilogo.</p>
      </div>

      <!-- METRICHE -->
      <div class="card">
        <div><b id="metrics_line1">Portafoglio (ETF Azion-Obblig + ETC Oro): ‚Ä¶</b></div>
        <div id="metrics_line2">Composizione: ‚Ä¶</div>
        <div id="metrics_line3">Raddoppio del portafoglio in anni: ‚Ä¶</div>
      </div>

      <!-- GRAFICO -->
      <div class="card" id="chartWrap">
        <canvas id="chart"></canvas>
      </div>

      <!-- ‚úÖ scritta richiesta sotto grafico -->
      <div class="muted" style="margin-top:8px;">
        <span id="data_updated">Dati aggiornati al ‚Äî</span>
      </div>

      <!-- SECONDA PARTE -->
      <div class="card">
        <b>Messaggio chiave:</b><br />
        La differenza non √® indovinare il mercato.<br />
        √à avere una struttura semplice e ribilanciarla una volta l‚Äôanno.
      </div>

      <div class="card">
        <h2>Come applicarlo concretamente</h2>
        <ol>
          <li>Scegli le percentuali (es. 80% ETF Azion-Obblig ‚Äì 20% Oro).</li>
          <li>
            Investi nei due strumenti attraverso la tua banca con
            <span class="execution-only-wrap">
              <span class="execution-only-trigger">‚Äúexecution only‚Äù</span>

              <!-- ‚úÖ Tooltip con anteprima PDF -->
              <span class="pdf-tooltip">
                <iframe src="/static/faxsimile_execution_only.pdf"></iframe>
              </span>

              <!-- ‚úÖ Link diretto PDF -->
              <a class="fax-btn" href="/static/faxsimile_execution_only.pdf" target="_blank" rel="noopener">
                üìÑ Faxsimile PDF
              </a>
            </span>.
          </li>
          <li>Non intervenire durante l‚Äôanno.</li>
          <li>A dicembre ribilancia ai pesi originali.</li>
        </ol>
      </div>

      <div class="grid2">
        <!-- DOMANDE LIBERE -->
        <div class="card noPrint">
          <h2>Domande libere</h2>
          <p class="muted">
            Scrivi una domanda. Riceverai una risposta dall‚Äôassistente (nessun dato viene salvato sul sito).<br />
            <b>Tip:</b> su PC invia con <b>Ctrl+Invio</b>.
          </p>

          <textarea id="ask_question" rows="5" placeholder="Scrivi qui la tua domanda‚Ä¶"></textarea>

          <div style="display:flex; align-items:center; gap:8px; margin-top:10px;">
            <button id="ask_btn" class="btn">Chiedi all‚Äôassistente</button>
            <span id="ask_remaining" class="muted"></span>
          </div>

          <div id="ask_status" class="info"></div>

          <div id="ask_answer" class="card" style="margin-top:12px; white-space: pre-wrap;"></div>

          <p class="muted" style="margin-top:10px;">
            Nota: risposta informativa, non consulenza finanziaria.
          </p>
        </div>

        <!-- FAQ -->
        <div class="card">
          <h2>FAQ (passa il mouse)</h2>
          <p class="muted">Su mobile: tocca la domanda per vedere la risposta.</p>

          <details><summary><b>1) Perch√© solo due strumenti?</b></summary>
            <p>Per semplicit√†, costi bassi e disciplina. Due ‚Äúmattoni‚Äù ben scelti spesso battono strategie complesse.</p>
          </details>

          <details><summary><b>2) Cos‚Äô√® l‚ÄôETF Azion-Obblig?</b></summary>
            <p>Un unico ETF globale ‚Äúbilanciato‚Äù. Qui assumiamo 80% azioni e 20% obbligazioni.</p>
          </details>

          <details><summary><b>3) Perch√© aggiungere oro?</b></summary>
            <p>Per diversificare e ridurre i ribassi in alcune fasi di mercato.</p>
          </details>

          <details><summary><b>4) Quando ribilanciare?</b></summary>
            <p>Una volta l‚Äôanno (es. a dicembre), riportando i pesi a quelli scelti.</p>
          </details>

          <details><summary><b>5) Devo ‚Äúindovinare‚Äù il momento giusto?</b></summary>
            <p>No: la logica √® evitare market timing. Conta la disciplina nel tempo.</p>
          </details>

          <details><summary><b>6) Cosa succede se dopo l‚Äôacquisto scende?</b></summary>
            <p>√à normale. La strategia presuppone volatilit√† e orizzonte lungo.</p>
          </details>

          <details><summary><b>7) Perch√© ‚Äúexecution only‚Äù?</b></summary>
            <p>Per ridurre conflitti di interesse e costi. Decidi tu la struttura.</p>
          </details>

          <details><summary><b>8) Che importo serve per iniziare?</b></summary>
            <p>Non esiste una cifra unica: l‚Äôimportante √® iniziare sostenibile e restare coerenti.</p>
          </details>

          <details><summary><b>9) Ogni quanto guardare il portafoglio?</b></summary>
            <p>Il meno possibile: controlli periodici, non quotidiani.</p>
          </details>

          <details><summary><b>10) Questo √® un consiglio personalizzato?</b></summary>
            <p>No. √à informazione generale, non consulenza finanziaria personalizzata.</p>
          </details>
        </div>
      </div>
    </div>

    <script src="/static/app.js"></script>
  </body>
</html>
